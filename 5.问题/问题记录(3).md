# 问题记录(3)

## 1.vscode启动node断点调试

- F5启动调试
- 在调试控制台可看到输出

```js
// launch.json 此时可在任意js文件下启动
{
  // 使用 IntelliSense 了解相关属性。
  // 悬停以查看现有属性的描述。
  // 欲了解更多信息，请访问: https://go.microsoft.com/fwlink/?linkid=830387
  "version": "0.2.0",
  "configurations": [
    {
      "type": "node",
      "request": "launch",
      "name": "Launch Program",
      "program": "${file}"
    }
  ]
}

// 指定启动的js文件
"program": "${workspaceFolder}\\server\\index.js"

// ./server/index.js
console.log(111)

console.log(222)

console.log(333)
```

## 2.element ui 表单验证手机号

```js
// 注册 data
const checkPhone = (rule, value, callback) => {
      if (!value) {
        return callback(new Error("请输入手机号"));
      } else {
        const reg = /^1[3|4|5|7|8]\d{9}$/;
        if (reg.test(value)) {
          this.$user
            .CheckMobileNumberExist({
              mobileNumber: this.form.phone
            })
            .then(res => {
              if (res.Code === 2) {
                return callback(new Error(res.Remark));
              } else if (res.Code === 1) {
                callback();
              }
            });
        } else {
          return callback(new Error("手机号格式不正确"));
        }
      }
    };

// rules
phone: [{ validator: checkPhone, trigger: "blur" }],
```

## 3.背景图片拉伸铺满整个屏幕

```css
.bg-img {
  background: url("../../assets/img/login_bg.png") no-repeat;
  height: 100%;
  width: 100%;
  background-size:cover;
  padding-top: 80px;
}
```

## 4.防止图片被拉伸

```css
// 使图片边缘隐藏
.box {
  background-image: url("./img/f61ed3285d5f3be1.jpg");
  width: 100%;
  height: 300px;
  min-width: 1200px;
  background-position: center;
}
```

## 5

## 6.异步请求等待前一个请求完成后再执行

```js
// promise
handleDelete() {
  DeleteMember({ memberId: this.item.MemberID })
  .then(()=>{
    this.GetAllMemberByUser()
  })
}

// es7
async handleDelete() {
  await DeleteMember({ memberId: this.item.MemberID });
  this.GetAllMemberByUser();
}
```

## 7.vue复选框选中状态记录

- 使用es6的Set，保证数组的值不重复

```js
// state
PersonCheckedSet1:new Set(), // 提交待参保成员

// mutations，执行复选框选中和未选中状态
addPersonCheckedSet1(state,memberId){
  state.PersonCheckedSet1.add(memberId)
  console.log(Array.from(state.PersonCheckedSet1))
},
deletePersonCheckedSet1(state,memberId){
  state.PersonCheckedSet1.delete(memberId)
  console.log(Array.from(state.PersonCheckedSet1))
}
```

## 8.使用for of替换for循环

```js
// const length = this.tableData.length;
// for (let i = 0; i < length; i++) {
//   this.tableData[i].sum =
//     this.tableData[i].CompanyPay + this.tableData[i].PersonPay;
// }
for (let index of this.tableData.keys()) {
  this.tableData[index].sum =
    this.tableData[index].CompanyPay + this.tableData[index].PersonPay;
}
```

## 9.elementUI table中使用select

```html
// 纯展示
<el-table-column prop="addMonth" label="新增月份"></el-table-column>

<template slot-scope="scope">
  <el-select
    v-model="selectMonth[scope.$index]"
    placeholder="选择缴纳月份"
    @change="changeMonth(scope.$index,scope.row)"
  >
    <el-option
      v-for="item in optionsMonth[scope.$index]"
      :key="item.value"
      :label="item.label"
      :value="item.value"
    ></el-option>
  </el-select>
</template>
```

## 10.vue无法响应数据变化

```js
this.optionsMonth.push( [
  {
    value: `${res.ResponseObject.Month}`,
    label: `${year}年${month}月~${endYear1}年${endMonth1}月`
  },
  {
    value: "3",
    label: `${year}年${month}月~${endYear2}年${endMonth2}月`
  },
  {
    value: "6",
    label: `${year}年${month}月~${endYear3}年${endMonth3}月`
  }
]);
// 部分数据响应
this.optionsMonth.splice(index, 1, [
  {
    value: `${res.ResponseObject.Month}`,
    label: `${year}年${month}月~${endYear1}年${endMonth1}月`
  },
  {
    value: "3",
    label: `${year}年${month}月~${endYear2}年${endMonth2}月`
  },
  {
    value: "6",
    label: `${year}年${month}月~${endYear3}年${endMonth3}月`
  }
]);
// 数据不响应
// this.optionsMonth[index] = [
//   {
//     value: `${res.ResponseObject.Month}`,
//     label: `${year}年${month}月~${endYear1}年${endMonth1}月`
//   },
//   {
//     value: "3",
//     label: `${year}年${month}月~${endYear2}年${endMonth2}月`
//   },
//   {
//     value: "6",
//     label: `${year}年${month}月~${endYear3}年${endMonth3}月`
//   }
// ];
```

## 11.elementui 文件上传

```html
<el-upload
  class="upload-demo"
  action="/api/Attach/Upload?ownerUserId=7163E609-C8ED-43AE-9EA8-980580346E60&aiCheck=1&ownerMemberIdCardNumber=abc"
  :on-preview="handlePreview"
  :on-remove="handleRemove"
  :before-remove="beforeRemove"
  multiple
  :headers="headers"
  :limit="3"
  :on-exceed="handleExceed"
  :file-list="fileList"
>
  <el-button size="small" type="primary">点击上传</el-button>
  <div slot="tip" class="el-upload__tip">只能上传jpg/png文件，且不超过500kb</div>
</el-upload>

// 设置header token
headers:{Authorization:`bearer ${JSON.parse(sessionStorage.getItem("key")).access_token}`},
```

## 12.在vuex的actions中发起异步请求，url刷新页面内容明显跳动

- 在vuex中定义变量loading，使用elementUI的v-loading，使页面在数据请求完成前处于遮罩加载状态

```js
state: {
  loading:true,
  PersonIngList: [],  // 待参保成员
  PersonEdList: [],  // 在保成员
  PersonCheckedSet1:new Set(), // 提交待参保成员
  PersonCheckedSet2:new Set() // 续保在保成员
},
mutations: {
  // 获取所有待参保和在保成员
  GetAllMemberByUser(state,data){
    state.PersonIngList=data.UnSocialMember
    state.PersonEdList=data.InSocialMember
    state.loading=false
  }
}
```

## 13.vue和react的对比

- 本质区别：vue本质是MVVM框架，由MVC发展而来；react本质是前端组件化框架，由后端组件化发展而来
- 模板的区别：vue使用模板指令，借鉴angular；react使用JSX
- 组件化的区别：vue是在MVVM上的扩展，react本身就是组件化
